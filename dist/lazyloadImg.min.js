"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(t){"function"==typeof define&&"object"===_typeof(define.amd)&&define.amd?define(t):"undefined"!=typeof module&&module.exports?module.exports=t():window.LazyloadImg=t()}(function(){function t(t){this.el="[data-src]",this.top=0,this.right=0,this.bottom=0,this.left=0,this.load=function(t){},this.error=function(t){},this.qriginal=!1,this.monitorEvent=["DOMContentLoaded","load","click","touchstart","touchend","haschange","online","pageshow","popstate","resize","storage","mousewheel","scroll"];for(var e in t)this[e]=t[e];this.init()}return t.prototype.init=function(){this.createStyle();var t=this;this.src=function(){return/\[data-([a-z]+)\]$/.exec(t.el)[1]||"src"}(),this.eachDOM=this.eachDOM.bind(this),this.start()},t.prototype.createStyle=function(){var t=document.getElementById("LazyloadImg-style");return t?!1:(t=document.createElement("style"),t.id="LazyloadImg-style",t.type="text/css",t.innerHTML="            .LazyloadImg-qriginal {                -webkit-transition: none!important;                -moz-transition: none!important;                -o-transition: none!important;                transition: none!important;                background-size: cover!important;                background-position: center center!important;                background-repeat: no-repeat!important;            }        ",void document.querySelector("head").appendChild(t))},t.prototype.start=function(){for(var t=this.monitorEvent,e=0;e<t.length;e++)window.addEventListener(t[e],this.eachDOM,!1);this.eachDOM()},t.prototype.eachDOM=function(t){for(var e=document.querySelectorAll(this.el),n=[],o=0;o<e.length;o++)this.testMeet(e[o])===!0&&n.push(e[o]);for(var o=0;o<n.length;o++)this.loadImg(n[o])},t.prototype.testMeet=function(t){var e=t.getBoundingClientRect(),n=t.offsetWidth,o=t.offsetHeight,i=window.innerWidth,r=window.innerHeight,a=!(e.right-this.left<=0&&e.left+n-this.left<=0||e.left+this.right>=i&&e.right+this.right>=n+i),s=!(e.bottom-this.top<=0&&e.top+o-this.top<=0||e.top+this.bottom>=r&&e.bottom+this.bottom>=o+r);return!(0==t.width||0==t.height||!a||!s)},t.prototype.loadImg=function(t){var e=this,n=t.dataset[this.src],o=new Image;o.src=n,o.addEventListener("load",function(){return e.qriginal?(t.src=e.getTransparent(t.src,t.width,t.height),t.className+=" LazyloadImg-qriginal",t.style.backgroundImage="url("+o.src+")"):t.src=o.src,delete t.dataset[e.src],e.load.call(e,t)},!1),o.addEventListener("error",function(){return e.error.call(e,t)},!1)},t.prototype.getTransparent=function(){var t=document.createElement("canvas");t.getContext("2d").globalAlpha=0;var e={};return function(n,o,i){if(e[n])return e[n];t.width=o,t.height=i;var r=t.toDataURL("image/png");return e[n]=r,r}}(),t.prototype.end=function(){for(var t=this.monitorEvent,e=0;e<t.length;e++)window.removeEventListener(t[e],this.eachDOM,!1)},t});